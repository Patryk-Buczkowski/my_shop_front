import{c as x,j as e,r as y}from"./index-CqHNKmGi.js";import{c as k}from"./react-0RTgqMaG.js";import{c as w,a as o,b as _,d as I,e as $}from"./index.esm-CT9w3V37.js";import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M5 12h14",key:"1ays0h"}]],z=x("Minus",q);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],J=x("Pencil",F);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],O=x("Plus",M);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],T=x("Trash2",A),d=s=>s.reduce((r,l)=>r+l.price*(l.amount||1),0),E=k(s=>({cart:JSON.parse(localStorage.getItem("cart")||"[]"),totalSum:d(JSON.parse(localStorage.getItem("cart")||"[]")),addToCart:r=>s(l=>{const n=l.cart.find(i=>i.id===r.id);let t;return n?t=l.cart.map(i=>i.id===r.id?{...i,amount:i.amount+1}:i):t=[...l.cart,{...r,amount:1}],localStorage.setItem("cart",JSON.stringify(t)),{cart:t,totalSum:d(JSON.parse(localStorage.getItem("cart")||"[]"))}}),removeFromCart:r=>s(l=>{const n=l.cart.filter(t=>t.id!==r);return localStorage.setItem("cart",JSON.stringify(n)),{cart:n,totalSum:d(JSON.parse(localStorage.getItem("cart")||"[]"))}}),increaseAmount:r=>s(l=>{const n=l.cart.map(t=>t.id===r?{...t,amount:t.amount+1}:t);return localStorage.setItem("cart",JSON.stringify(n)),{cart:n,totalSum:d(JSON.parse(localStorage.getItem("cart")||"[]"))}}),decreaseAmount:r=>s(l=>{const n=l.cart.map(t=>t.id===r?{...t,amount:t.amount-1}:t).filter(t=>t.amount>0);return localStorage.setItem("cart",JSON.stringify(n)),{cart:n,totalSum:d(JSON.parse(localStorage.getItem("cart")||"[]"))}})})),P=({product:s,subtract:r})=>e.jsx(e.Fragment,{children:e.jsx("div",{onClick:()=>r(s.id),className:"w-5 h-5 flex justify-items-center justify-center align-baseline rounded-full border-2 border-[var(--color-primary)]",children:e.jsx(z,{color:"var(--color-primary)",size:15})})}),R=({product:s,add:r})=>e.jsx(e.Fragment,{children:e.jsx("div",{onClick:()=>r(s),className:"w-5 h-5 flex justify-items-center justify-center align-baseline rounded-full border-2 border-[var(--color-primary)]",children:e.jsx(O,{color:"var(--color-primary)",size:15})})}),Z=()=>{const{cart:s,totalSum:r,addToCart:l,decreaseAmount:n,removeFromCart:t}=E(),[i,j]=y.useState(null),[h,m]=y.useState(!1),f=["city","country","street_number","voivodeship","zip_code"],g=w({country:o().required("Country is required"),city:o().required("City is required"),street_number:o().required("Street number is required"),voivodeship:o().required("Region is required"),zip_code:o().required("Zip code is required")}),v=(a,u)=>{a.key==="Escape"&&(u(),m(!1))};return e.jsxs("div",{className:"flex flex-col w-full p-1 gap-0.5",children:[e.jsx("h3",{className:"font-bold select-none tracking-wider",children:"Cart"}),!h&&e.jsxs("div",{className:"flex justify-between max-w-[300px] pb-3 items-end",children:[e.jsx("span",{children:i===null?e.jsx("p",{className:"select-none",children:"Add delivery address :"}):e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Delivery address"}),e.jsxs("p",{children:["Country: ",i.country]}),e.jsxs("p",{children:["City: ",i.city]}),e.jsxs("p",{children:["Street & number: ",i.street_number]}),e.jsxs("p",{children:["Zip code: ",i.zip_code]})]})}),e.jsxs("div",{className:"flex items-center gap-2",onClick:()=>m(!0),children:[e.jsx(J,{size:14}),e.jsx("span",{className:"font-extrabold tracking-wider text-lg text-[var(--color-secondary)]",children:"Edit"})]})]}),h&&e.jsx(_,{initialValues:{country:"",city:"",street_number:"",voivodeship:"",zip_code:""},validationSchema:g,onSubmit:a=>{j(a),m(!1)},children:({handleChange:a,handleBlur:u,values:b,errors:p,touched:N,resetForm:S})=>e.jsxs(I,{className:"pb-3",children:[f.map(c=>e.jsxs("div",{className:"mb-2",children:[e.jsx($,{className:"mb-1 rounded-md text-sm border-2 border-[var(--color-primary-light)] max-w-[200px]",type:"text",name:c,placeholder:`Type ${c}`,onChange:a,onBlur:u,value:b[c],onKeyDown:C=>v(C,S)}),p[c]&&N[c]&&e.jsx("div",{className:"text-red-500 text-xs",children:p[c]})]},c)),e.jsx("button",{className:"ml-3 p-1 rounded-md border-1 bg-[var(--color-secondary)] select-none active:text-[var(--color-primary-light)]",type:"submit",onClick:()=>console.log(i),children:"Save Address ✅"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"ml-3 p-1 rounded-md border-1 bg-[var(--color-secondary)] select-none  active:border-red-600",children:"❌"})]})}),s.length!==0&&e.jsx("div",{children:s.map(a=>e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsxs("div",{className:"relative h-fit",children:[e.jsx("img",{className:"relative w-[85px] h-[85px]",src:a.pictureUrl,alt:"product image"}),e.jsx("div",{onClick:()=>t(a.id),className:"absolute w-5.5 h-5.5 rounded-full bottom-2 left-1 bg-white flex justify-center items-center",children:e.jsx(T,{size:13,color:"red"})})]}),e.jsxs("div",{className:"max-w-[210px] flex pl-2 flex-col gap-1 text-sm font-light",children:[e.jsx("p",{children:a.title}),e.jsx("p",{children:a.description}),e.jsxs("p",{children:[" avg Rate: ",a.averageRate.toFixed(2)??"N/A"]}),e.jsxs("span",{className:"flex justify-between",children:[e.jsx("p",{className:"font-bold",children:`$${(a.price*a.amount).toFixed(2)??"N/A"}`}),e.jsxs("span",{className:"flex justify-between min-w-[35%] max-w-[40%]",children:[e.jsx(R,{product:a,add:l}),e.jsx("p",{className:"rounded-lg text-[var(--color-secondary)] font-semibold w-5 text-center items-center bg-[var(--color-primary-light)]",children:`${a.amount}`}),e.jsx(P,{product:a,subtract:n})]})]})]})]},a.id))}),s.length!==0?e.jsx("p",{children:`Total sum $${r}`}):e.jsx("p",{children:"0"})]})};export{Z as default};
